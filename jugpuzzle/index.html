<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Foraging Research: Water Jug Task</title>
    <style>
        :root { --primary: #2196F3; --bg: #f4f4f9; }
        body { font-family: sans-serif; background: var(--bg); display: flex; flex-direction: column; align-items: center; }
        
        #config-panel { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin: 20px; width: 350px; }
        .input-group { margin-bottom: 10px; display: flex; justify-content: space-between; }
        
        #game-container { display: flex; gap: 40px; margin-top: 30px; align-items: flex-end; height: 300px; }
        .jug-wrapper { display: flex; flex-direction: column; align-items: center; }
        .jug { border: 4px solid #333; border-top: none; border-radius: 0 0 10px 10px; width: 100px; position: relative; background: #fff; cursor: pointer; transition: transform 0.1s; }
        .jug:hover { transform: scale(1.05); }
        .water { position: absolute; bottom: 0; width: 100%; background: var(--primary); transition: height 0.3s ease; }
        .label { margin-top: 10px; font-weight: bold; }

        .controls { margin-top: 30px; display: flex; gap: 10px; }
        button { padding: 10px 20px; cursor: pointer; border-radius: 5px; border: none; background: #333; color: white; }
        button:hover { background: #555; }
        #status-msg { margin-top: 20px; font-size: 1.2em; color: #2c3e50; font-weight: bold; }
        .target-box { background: #ffd700; padding: 15px; border-radius: 8px; font-size: 1.5em; margin-top: 10px; }
    </style>
</head>
<body>

<div id="config-panel">
    <h3>Experiment Config</h3>
    <div class="input-group">Capacity Jug A: <input type="number" id="capA" value="5"></div>
    <div class="input-group">Capacity Jug B: <input type="number" id="capB" value="3"></div>
    <div class="input-group">Target Amount: <input type="number" id="target" value="4"></div>
    <p style="font-size: 0.8em; color: #666;">*If Target isn't a multiple of GCD(A,B), it's impossible.</p>
    <button onclick="initGame()" style="width: 100%; background: #4CAF50;">Start New Trial</button>
</div>

<div class="target-box">Target: <span id="target-val">0</span>L</div>

<div id="game-container">
    <div class="jug-wrapper">
        <div id="jugA" class="jug" onclick="selectJug('A')"><div id="waterA" class="water"></div></div>
        <div class="label">Jug A (<span id="curA">0</span>/<span id="maxA">0</span>L)</div>
    </div>
    <div class="jug-wrapper">
        <div id="jugB" class="jug" onclick="selectJug('B')"><div id="waterB" class="water"></div></div>
        <div class="label">Jug B (<span id="curB">0</span>/<span id="maxB">0</span>L)</div>
    </div>
</div>

<div class="controls">
    <button onclick="fillJug()">Fill Selected</button>
    <button onclick="emptyJug()">Empty Selected</button>
    <button onclick="transfer()">Pour into Other</button>
</div>

<div id="status-msg">Click a jug to select it.</div>

<script>
    let state = { capA: 5, capB: 3, curA: 0, curB: 0, target: 4, selected: 'A' };

    function initGame() {
        state.capA = parseInt(document.getElementById('capA').value);
        state.capB = parseInt(document.getElementById('capB').value);
        state.target = parseInt(document.getElementById('target').value);
        state.curA = 0;
        state.curB = 0;
        
        // Dynamic Height UI
        const maxVisual = Math.max(state.capA, state.capB);
        document.getElementById('jugA').style.height = (state.capA / maxVisual * 200) + 'px';
        document.getElementById('jugB').style.height = (state.capB / maxVisual * 200) + 'px';
        
        updateUI();
        document.getElementById('status-msg').innerText = "Trial Started!";
    }

    function selectJug(id) {
        state.selected = id;
        document.getElementById('jugA').style.borderColor = state.selected === 'A' ? '#2196F3' : '#333';
        document.getElementById('jugB').style.borderColor = state.selected === 'B' ? '#2196F3' : '#333';
    }

    function fillJug() {
        if (state.selected === 'A') state.curA = state.capA;
        else state.curB = state.capB;
        updateUI();
    }

    function emptyJug() {
        if (state.selected === 'A') state.curA = 0;
        else state.curB = 0;
        updateUI();
    }

    function transfer() {
        if (state.selected === 'A') {
            let spaceInB = state.capB - state.curB;
            let amountToPour = Math.min(state.curA, spaceInB);
            state.curA -= amountToPour;
            state.curB += amountToPour;
        } else {
            let spaceInA = state.capA - state.curA;
            let amountToPour = Math.min(state.curB, spaceInA);
            state.curB -= amountToPour;
            state.curA += amountToPour;
        }
        updateUI();
    }

    function updateUI() {
        document.getElementById('waterA').style.height = (state.curA / state.capA * 100) + '%';
        document.getElementById('waterB').style.height = (state.curB / state.capB * 100) + '%';
        document.getElementById('curA').innerText = state.curA;
        document.getElementById('curB').innerText = state.curB;
        document.getElementById('maxA').innerText = state.capA;
        document.getElementById('maxB').innerText = state.capB;
        document.getElementById('target-val').innerText = state.target;

        if (state.curA === state.target || state.curB === state.target) {
            document.getElementById('status-msg').innerText = "SUCCESS! Target reached.";
        }
    }

    initGame();
</script>
</body>
</html>